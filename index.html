<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>英文語塊學習卡 (Lexical Chunks)</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background-color: #f0f9ff; /* 淺藍色背景，護眼 */
        }
        .perspective-1000 {
            perspective: 1000px;
        }
        .transform-style-3d {
            transform-style: preserve-3d;
        }
        .backface-hidden {
            backface-visibility: hidden;
        }
        .rotate-y-180 {
            transform: rotateY(180deg);
        }
        /* 翻轉動畫 */
        .card-container {
            transition: transform 0.6s;
            transform-style: preserve-3d;
            position: relative;
            width: 100%;
            height: 100%;
        }
        .card-container.flipped {
            transform: rotateY(180deg);
        }
        .btn-hover:active {
            transform: scale(0.95);
        }
    </style>
</head>
<body class="flex flex-col h-screen overflow-hidden">

    <!-- Header -->
    <header class="bg-blue-600 text-white p-4 shadow-md z-10">
        <div class="max-w-md mx-auto flex justify-between items-center">
            <h1 class="text-xl font-bold"><i class="fas fa-layer-group mr-2"></i>語塊學習 (Lexical Chunks)</h1>
            <div class="text-sm opacity-80" id="progress-display">0 / 0</div>
        </div>
    </header>

    <!-- Main Content Area -->
    <main class="flex-1 flex flex-col items-center justify-center p-4 relative">
        
        <!-- Flashcard Area -->
        <div class="w-full max-w-md h-[500px] perspective-1000 cursor-pointer group" onclick="flipCard()">
            <div id="card-inner" class="card-container w-full h-full relative shadow-xl rounded-2xl">
                
                <!-- Front Side (English) -->
                <div class="absolute w-full h-full bg-white rounded-2xl p-8 flex flex-col justify-between items-center backface-hidden border-2 border-blue-100">
                    <div class="w-full flex justify-between items-start text-gray-400">
                        <span class="text-xs uppercase tracking-wider">English Chunk</span>
                        <i class="fas fa-volume-up text-2xl text-blue-500 hover:text-blue-700 p-2 btn-hover transition" onclick="event.stopPropagation(); playAudio()"></i>
                    </div>
                    
                    <div class="flex-1 flex flex-col justify-center items-center text-center">
                        <h2 id="card-chunk" class="text-4xl font-bold text-gray-800 mb-4 leading-tight"></h2>
                        <p id="card-ipa" class="text-lg text-blue-500 font-mono bg-blue-50 px-3 py-1 rounded-full"></p>
                    </div>

                    <div class="w-full border-t border-gray-100 pt-4">
                        <p class="text-sm text-gray-500 text-center mb-2">Example Sentences:</p>
                        <ul class="text-left text-gray-700 space-y-2 text-sm">
                            <li class="flex items-start"><span class="text-blue-400 mr-2">➤</span><span id="card-ex1"></span></li>
                            <li class="flex items-start"><span class="text-blue-400 mr-2">➤</span><span id="card-ex2"></span></li>
                        </ul>
                    </div>
                    
                    <div class="absolute bottom-4 text-gray-300 text-xs animate-pulse">
                        Tap to flip
                    </div>
                </div>

                <!-- Back Side (Chinese & Analysis) -->
                <div class="absolute w-full h-full bg-slate-800 text-white rounded-2xl p-8 flex flex-col rotate-y-180 backface-hidden border-2 border-slate-700">
                    <div class="w-full flex justify-between items-start text-gray-400 mb-6">
                        <span class="text-xs uppercase tracking-wider">Analysis</span>
                        <i class="fas fa-lightbulb text-yellow-400"></i>
                    </div>

                    <div class="flex-1 overflow-y-auto">
                        <h3 id="card-meaning" class="text-3xl font-bold text-yellow-300 mb-4 text-center"></h3>
                        
                        <div class="bg-slate-700/50 rounded-lg p-4 mb-4">
                            <h4 class="text-xs text-gray-400 uppercase mb-2 font-bold">實用筆記 (Grammar Note)</h4>
                            <p id="card-note" class="text-gray-200 leading-relaxed"></p>
                        </div>

                        <div class="bg-slate-700/50 rounded-lg p-4">
                            <h4 class="text-xs text-gray-400 uppercase mb-2 font-bold">使用情境 (Context)</h4>
                            <p id="card-context" class="text-gray-200 leading-relaxed text-sm"></p>
                        </div>
                    </div>
                </div>

            </div>
        </div>

    </main>

    <!-- Controls -->
    <footer class="bg-white border-t border-gray-200 p-4">
        <div class="max-w-md mx-auto flex justify-between items-center gap-4">
            <button onclick="prevCard()" class="flex-1 bg-gray-100 hover:bg-gray-200 text-gray-700 font-bold py-3 px-4 rounded-xl transition btn-hover flex justify-center items-center">
                <i class="fas fa-arrow-left mr-2"></i> Prev
            </button>
            <button onclick="shuffleCards()" class="bg-blue-100 hover:bg-blue-200 text-blue-600 p-3 rounded-xl transition btn-hover" title="Shuffle">
                <i class="fas fa-random"></i>
            </button>
            <button onclick="nextCard()" class="flex-1 bg-blue-600 hover:bg-blue-700 text-white font-bold py-3 px-4 rounded-xl shadow-lg shadow-blue-200 transition btn-hover flex justify-center items-center">
                Next <i class="fas fa-arrow-right ml-2"></i>
            </button>
        </div>
    </footer>

    <script>
        // --- 專家擴充後的語塊資料庫 (基於 CSV 內容) ---
        const chunksData = [
                                      {
                                        "chunk": "how many steps",
                                        "meaning": "多少步",
                                        "note": "詢問數量用 how many",
                                        "ex1": "Example sentence pending...",
                                        "ex2": "",
                                        "ipa": "",
                                        "context": ""
                                      },
                                      {
                                        "chunk": "every day",
                                        "meaning": "每天",
                                        "note": "放句尾的時間語塊",
                                        "ex1": "Example sentence pending...",
                                        "ex2": "",
                                        "ipa": "",
                                        "context": ""
                                      },
                                      {
                                        "chunk": "is enough for...",
                                        "meaning": "對...是足夠的",
                                        "note": "好用句型：Money is enough for me.",
                                        "ex1": "Example sentence pending...",
                                        "ex2": "",
                                        "ipa": "",
                                        "context": ""
                                      },
                                      {
                                        "chunk": "live longer",
                                        "meaning": "活得更久",
                                        "note": "longer 是 long 的比較級",
                                        "ex1": "Example sentence pending...",
                                        "ex2": "",
                                        "ipa": "",
                                        "context": ""
                                      },
                                      {
                                        "chunk": "looked at",
                                        "meaning": "查看/檢視",
                                        "note": "過去式 look -> looked",
                                        "ex1": "Example sentence pending...",
                                        "ex2": "",
                                        "ipa": "",
                                        "context": ""
                                      },
                                      {
                                        "chunk": "concluded that...",
                                        "meaning": "下結論說...",
                                        "note": "寫報告或表達觀點時的高級字",
                                        "ex1": "Example sentence pending...",
                                        "ex2": "",
                                        "ipa": "",
                                        "context": ""
                                      },
                                      {
                                        "chunk": "lowered the risk",
                                        "meaning": "降低了風險",
                                        "note": "lower 這裡當動詞用",
                                        "ex1": "Example sentence pending...",
                                        "ex2": "",
                                        "ipa": "",
                                        "context": ""
                                      },
                                      {
                                        "chunk": "heart disease",
                                        "meaning": "心臟病",
                                        "note": "固定搭配",
                                        "ex1": "Example sentence pending...",
                                        "ex2": "",
                                        "ipa": "",
                                        "context": ""
                                      },
                                      {
                                        "chunk": "is bad for...",
                                        "meaning": "對...是有害的",
                                        "note": "相反詞是 is good for",
                                        "ex1": "Example sentence pending...",
                                        "ex2": "",
                                        "ipa": "",
                                        "context": ""
                                      },
                                      {
                                        "chunk": "look at their phones",
                                        "meaning": "看著他們的手機",
                                        "note": "記得是用 at",
                                        "ex1": "Example sentence pending...",
                                        "ex2": "",
                                        "ipa": "",
                                        "context": ""
                                      },
                                      {
                                        "chunk": "in bed",
                                        "meaning": "在床上",
                                        "note": "不用說 on the bed，習慣說 in bed",
                                        "ex1": "Example sentence pending...",
                                        "ex2": "",
                                        "ipa": "",
                                        "context": ""
                                      },
                                      {
                                        "chunk": "fall asleep",
                                        "meaning": "睡著",
                                        "note": "這是一個動作，不是 sleeping",
                                        "ex1": "Example sentence pending...",
                                        "ex2": "",
                                        "ipa": "",
                                        "context": ""
                                      },
                                      {
                                        "chunk": "stop using",
                                        "meaning": "停止使用",
                                        "note": "stop + Ving (停止做某事)",
                                        "ex1": "Example sentence pending...",
                                        "ex2": "",
                                        "ipa": "",
                                        "context": ""
                                      },
                                      {
                                        "chunk": "before bedtime",
                                        "meaning": "在睡覺時間之前",
                                        "note": "before + 時間點",
                                        "ex1": "Example sentence pending...",
                                        "ex2": "",
                                        "ipa": "",
                                        "context": ""
                                      },
                                      {
                                        "chunk": "around the world",
                                        "meaning": "世界各地",
                                        "note": "常見地點語塊",
                                        "ex1": "Example sentence pending...",
                                        "ex2": "",
                                        "ipa": "",
                                        "context": ""
                                      },
                                      {
                                        "chunk": "brings good news",
                                        "meaning": "帶來好消息",
                                        "note": "bring 加了 s (單數主詞)",
                                        "ex1": "Example sentence pending...",
                                        "ex2": "",
                                        "ipa": "",
                                        "context": ""
                                      },
                                      {
                                        "chunk": "helps our heart",
                                        "meaning": "幫助我們的心臟/有益心臟",
                                        "note": "help 加了 s",
                                        "ex1": "Example sentence pending...",
                                        "ex2": "",
                                        "ipa": "",
                                        "context": ""
                                      },
                                      {
                                        "chunk": "looked at",
                                        "meaning": "查看/調查",
                                        "note": "過去式 (look -> looked)",
                                        "ex1": "Example sentence pending...",
                                        "ex2": "",
                                        "ipa": "",
                                        "context": ""
                                      },
                                      {
                                        "chunk": "too much sugar",
                                        "meaning": "太多的糖",
                                        "note": "sugar 不可數，用 much",
                                        "ex1": "Example sentence pending...",
                                        "ex2": "",
                                        "ipa": "",
                                        "context": ""
                                      },
                                      {
                                        "chunk": "the best choice",
                                        "meaning": "最好的選擇",
                                        "note": "good 的最高級 -> the best",
                                        "ex1": "Example sentence pending...",
                                        "ex2": "",
                                        "ipa": "",
                                        "context": ""
                                      },
                                      {
                                        "chunk": "pay with cash",
                                        "meaning": "用現金支付",
                                        "note": "介系詞用 with",
                                        "ex1": "Example sentence pending...",
                                        "ex2": "",
                                        "ipa": "",
                                        "context": ""
                                      },
                                      {
                                        "chunk": "prefer to use",
                                        "meaning": "更喜歡使用/偏好使用",
                                        "note": "prefer = 比較喜歡",
                                        "ex1": "Example sentence pending...",
                                        "ex2": "",
                                        "ipa": "",
                                        "context": ""
                                      },
                                      {
                                        "chunk": "credit cards",
                                        "meaning": "信用卡",
                                        "note": "通常用複數",
                                        "ex1": "Example sentence pending...",
                                        "ex2": "",
                                        "ipa": "",
                                        "context": ""
                                      },
                                      {
                                        "chunk": "faster and easier",
                                        "meaning": "更快且更容易",
                                        "note": "比較級 (fast+er / easy -> easier)",
                                        "ex1": "Example sentence pending...",
                                        "ex2": "",
                                        "ipa": "",
                                        "context": ""
                                      },
                                      {
                                        "chunk": "anymore",
                                        "meaning": "再也(不)...",
                                        "note": "用於否定句句尾 (not ... anymore)",
                                        "ex1": "Example sentence pending...",
                                        "ex2": "",
                                        "ipa": "",
                                        "context": ""
                                      },
                                      {
                                        "chunk": "a big change",
                                        "meaning": "一個巨大的改變",
                                        "note": "change 這裡當名詞",
                                        "ex1": "Example sentence pending...",
                                        "ex2": "",
                                        "ipa": "",
                                        "context": ""
                                      },
                                      {
                                        "chunk": "spend time",
                                        "meaning": "花時間",
                                        "note": "spend + time + in/on...",
                                        "ex1": "Example sentence pending...",
                                        "ex2": "",
                                        "ipa": "",
                                        "context": ""
                                      },
                                      {
                                        "chunk": "in nature",
                                        "meaning": "在大自然中",
                                        "note": "不用加 the (in the nature ❌)",
                                        "ex1": "Example sentence pending...",
                                        "ex2": "",
                                        "ipa": "",
                                        "context": ""
                                      },
                                      {
                                        "chunk": "reduce stress",
                                        "meaning": "減少壓力",
                                        "note": "reduce = 減少/降低",
                                        "ex1": "Example sentence pending...",
                                        "ex2": "",
                                        "ipa": "",
                                        "context": ""
                                      },
                                      {
                                        "chunk": "mental health",
                                        "meaning": "心理健康",
                                        "note": "相對於 physical health (身體健康)",
                                        "ex1": "Example sentence pending...",
                                        "ex2": "",
                                        "ipa": "",
                                        "context": ""
                                      },
                                      {
                                        "chunk": "feel relaxed",
                                        "meaning": "感到放鬆的",
                                        "note": "人的感覺用 -ed 結尾 (relaxed)",
                                        "ex1": "Example sentence pending...",
                                        "ex2": "",
                                        "ipa": "",
                                        "context": ""
                                      },
                                      {
                                        "chunk": "green spaces",
                                        "meaning": "綠地/綠色空間",
                                        "note": "公園、森林都算",
                                        "ex1": "Example sentence pending...",
                                        "ex2": "",
                                        "ipa": "",
                                        "context": ""
                                      },
                                      {
                                        "chunk": "learn how to",
                                        "meaning": "學習如何去...",
                                        "note": "learn how to swim/cook...",
                                        "ex1": "Example sentence pending...",
                                        "ex2": "",
                                        "ipa": "",
                                        "context": ""
                                      },
                                      {
                                        "chunk": "make mistakes",
                                        "meaning": "犯錯",
                                        "note": "固定搭配 make (不做 do mistakes)",
                                        "ex1": "Example sentence pending...",
                                        "ex2": "",
                                        "ipa": "",
                                        "context": ""
                                      },
                                      {
                                        "chunk": "don't give up",
                                        "meaning": "不要放棄",
                                        "note": "give up = 放棄",
                                        "ex1": "Example sentence pending...",
                                        "ex2": "",
                                        "ipa": "",
                                        "context": ""
                                      },
                                      {
                                        "chunk": "get better at",
                                        "meaning": "在...方面變更好",
                                        "note": "at 後面接名詞或 V-ing",
                                        "ex1": "Example sentence pending...",
                                        "ex2": "",
                                        "ipa": "",
                                        "context": ""
                                      },
                                      {
                                        "chunk": "It takes time",
                                        "meaning": "這需要時間",
                                        "note": "這裡的 take 是「花費」的意思",
                                        "ex1": "Example sentence pending...",
                                        "ex2": "",
                                        "ipa": "",
                                        "context": ""
                                      },
                                      {
                                        "chunk": "practice every day",
                                        "meaning": "每天練習",
                                        "note": "成功的關鍵",
                                        "ex1": "Example sentence pending...",
                                        "ex2": "",
                                        "ipa": "",
                                        "context": ""
                                      },
                                      {
                                        "chunk": "book a flight",
                                        "meaning": "訂機票",
                                        "note": "book 當動詞是「預訂」",
                                        "ex1": "Example sentence pending...",
                                        "ex2": "",
                                        "ipa": "",
                                        "context": ""
                                      },
                                      {
                                        "chunk": "stay in a hotel",
                                        "meaning": "住飯店",
                                        "note": "stay in + 住宿地點",
                                        "ex1": "Example sentence pending...",
                                        "ex2": "",
                                        "ipa": "",
                                        "context": ""
                                      },
                                      {
                                        "chunk": "pack my bags",
                                        "meaning": "打包行李",
                                        "note": "pack = 打包",
                                        "ex1": "Example sentence pending...",
                                        "ex2": "",
                                        "ipa": "",
                                        "context": ""
                                      },
                                      {
                                        "chunk": "take photos",
                                        "meaning": "拍照",
                                        "note": "固定搭配 take",
                                        "ex1": "Example sentence pending...",
                                        "ex2": "",
                                        "ipa": "",
                                        "context": ""
                                      },
                                      {
                                        "chunk": "can't wait",
                                        "meaning": "等不及了/超期待",
                                        "note": "表達興奮的最高級",
                                        "ex1": "Example sentence pending...",
                                        "ex2": "",
                                        "ipa": "",
                                        "context": ""
                                      },
                                      {
                                        "chunk": "visit famous places",
                                        "meaning": "參觀著名景點",
                                        "note": "visit = 參觀/拜訪",
                                        "ex1": "Example sentence pending...",
                                        "ex2": "",
                                        "ipa": "",
                                        "context": ""
                                      },
                                      {
                                        "chunk": "sit for a long time",
                                        "meaning": "坐很久/坐很長一段時間",
                                        "note": "for + 時間長度",
                                        "ex1": "Example sentence pending...",
                                        "ex2": "",
                                        "ipa": "",
                                        "context": ""
                                      },
                                      {
                                        "chunk": "at work / at home",
                                        "meaning": "在工作 / 在家",
                                        "note": "注意：不用加 the",
                                        "ex1": "Example sentence pending...",
                                        "ex2": "",
                                        "ipa": "",
                                        "context": ""
                                      },
                                      {
                                        "chunk": "too much",
                                        "meaning": "太多",
                                        "note": "修飾不可數或動作程度",
                                        "ex1": "Example sentence pending...",
                                        "ex2": "",
                                        "ipa": "",
                                        "context": ""
                                      },
                                      {
                                        "chunk": "stand up",
                                        "meaning": "站起來",
                                        "note": "常見動作片語",
                                        "ex1": "Example sentence pending...",
                                        "ex2": "",
                                        "ipa": "",
                                        "context": ""
                                      },
                                      {
                                        "chunk": "move more",
                                        "meaning": "多活動/多動一點",
                                        "note": "move = 移動/活動",
                                        "ex1": "Example sentence pending...",
                                        "ex2": "",
                                        "ipa": "",
                                        "context": ""
                                      },
                                      {
                                        "chunk": "every hour",
                                        "meaning": "每小時",
                                        "note": "頻率副詞",
                                        "ex1": "Example sentence pending...",
                                        "ex2": "",
                                        "ipa": "",
                                        "context": ""
                                      },
                                      {
                                        "chunk": "junk food",
                                        "meaning": "垃圾食物",
                                        "note": "雖然叫 junk (垃圾)，但指高熱量食物",
                                        "ex1": "Example sentence pending...",
                                        "ex2": "",
                                        "ipa": "",
                                        "context": ""
                                      },
                                      {
                                        "chunk": "gain weight",
                                        "meaning": "變胖/增加體重",
                                        "note": "比較禮貌的說法 (不直接說 get fat)",
                                        "ex1": "Example sentence pending...",
                                        "ex2": "",
                                        "ipa": "",
                                        "context": ""
                                      },
                                      {
                                        "chunk": "processed food",
                                        "meaning": "加工食品",
                                        "note": "process (處理) + ed",
                                        "ex1": "Example sentence pending...",
                                        "ex2": "",
                                        "ipa": "",
                                        "context": ""
                                      },
                                      {
                                        "chunk": "stay healthy",
                                        "meaning": "保持健康",
                                        "note": "stay 這裡指「保持狀態」",
                                        "ex1": "Example sentence pending...",
                                        "ex2": "",
                                        "ipa": "",
                                        "context": ""
                                      },
                                      {
                                        "chunk": "should avoid",
                                        "meaning": "應該避免",
                                        "note": "avoid + V-ing (避免做某事)",
                                        "ex1": "Example sentence pending...",
                                        "ex2": "",
                                        "ipa": "",
                                        "context": ""
                                      },
                                      {
                                        "chunk": "fresh fruit",
                                        "meaning": "新鮮水果",
                                        "note": "fresh = 新鮮的",
                                        "ex1": "Example sentence pending...",
                                        "ex2": "",
                                        "ipa": "",
                                        "context": ""
                                      },
                                      {
                                        "chunk": "work from home",
                                        "meaning": "在家工作",
                                        "note": "簡稱 WFH",
                                        "ex1": "Example sentence pending...",
                                        "ex2": "",
                                        "ipa": "",
                                        "context": ""
                                      },
                                      {
                                        "chunk": "save time",
                                        "meaning": "節省時間",
                                        "note": "相反詞是 waste time (浪費時間)",
                                        "ex1": "Example sentence pending...",
                                        "ex2": "",
                                        "ipa": "",
                                        "context": ""
                                      },
                                      {
                                        "chunk": "travel to work",
                                        "meaning": "通勤/去上班",
                                        "note": "也可以說 commute",
                                        "ex1": "Example sentence pending...",
                                        "ex2": "",
                                        "ipa": "",
                                        "context": ""
                                      },
                                      {
                                        "chunk": "office workers",
                                        "meaning": "上班族/辦公室員工",
                                        "note": "office + worker",
                                        "ex1": "Example sentence pending...",
                                        "ex2": "",
                                        "ipa": "",
                                        "context": ""
                                      },
                                      {
                                        "chunk": "online meetings",
                                        "meaning": "線上會議",
                                        "note": "透過 Zoom/Teams 開會",
                                        "ex1": "Example sentence pending...",
                                        "ex2": "",
                                        "ipa": "",
                                        "context": ""
                                      },
                                      {
                                        "chunk": "miss their friends",
                                        "meaning": "想念他們的朋友",
                                        "note": "miss 這裡當「想念」",
                                        "ex1": "Example sentence pending...",
                                        "ex2": "",
                                        "ipa": "",
                                        "context": ""
                                      },
                                      {
                                        "chunk": "throw away",
                                        "meaning": "丟棄/扔掉",
                                        "note": "throw = 丟",
                                        "ex1": "Example sentence pending...",
                                        "ex2": "",
                                        "ipa": "",
                                        "context": ""
                                      },
                                      {
                                        "chunk": "leftover food",
                                        "meaning": "剩菜/剩下的食物",
                                        "note": "leftover 當形容詞",
                                        "ex1": "Example sentence pending...",
                                        "ex2": "",
                                        "ipa": "",
                                        "context": ""
                                      },
                                      {
                                        "chunk": "save money",
                                        "meaning": "省錢",
                                        "note": "跟 save time (省時) 一樣好用",
                                        "ex1": "Example sentence pending...",
                                        "ex2": "",
                                        "ipa": "",
                                        "context": ""
                                      },
                                      {
                                        "chunk": "expiry date",
                                        "meaning": "有效期限/到期日",
                                        "note": "超市購物必看",
                                        "ex1": "Example sentence pending...",
                                        "ex2": "",
                                        "ipa": "",
                                        "context": ""
                                      },
                                      {
                                        "chunk": "check the fridge",
                                        "meaning": "檢查冰箱",
                                        "note": "fridge 是 refrigerator 的簡稱",
                                        "ex1": "Example sentence pending...",
                                        "ex2": "",
                                        "ipa": "",
                                        "context": ""
                                      },
                                      {
                                        "chunk": "go shopping",
                                        "meaning": "去購物",
                                        "note": "go + V-ing",
                                        "ex1": "Example sentence pending...",
                                        "ex2": "",
                                        "ipa": "",
                                        "context": ""
                                      }
                                    ];

        let currentIndex = 0;
        let isFlipped = false;

        // 初始化
        document.addEventListener('DOMContentLoaded', () => {
            loadCard(currentIndex);
        });

        function loadCard(index) {
            const data = chunksData[index];
            
            // Front
            document.getElementById('card-chunk').innerText = data.chunk;
            document.getElementById('card-ipa').innerText = data.ipa;
            document.getElementById('card-ex1').innerText = data.ex1;
            document.getElementById('card-ex2').innerText = data.ex2;

            // Back
            document.getElementById('card-meaning').innerText = data.meaning;
            document.getElementById('card-note').innerText = data.note;
            document.getElementById('card-context').innerText = data.context;

            // Progress
            document.getElementById('progress-display').innerText = `${index + 1} / ${chunksData.length}`;

            // Reset Flip
            const cardInner = document.getElementById('card-inner');
            if (isFlipped) {
                cardInner.classList.remove('flipped');
                isFlipped = false;
            }
        }

        function flipCard() {
            const cardInner = document.getElementById('card-inner');
            cardInner.classList.toggle('flipped');
            isFlipped = !isFlipped;
        }

        function nextCard() {
            if (currentIndex < chunksData.length - 1) {
                currentIndex++;
                loadCard(currentIndex);
            } else {
                // Loop back to start or alert
                currentIndex = 0;
                loadCard(currentIndex);
            }
        }

        function prevCard() {
            if (currentIndex > 0) {
                currentIndex--;
                loadCard(currentIndex);
            } else {
                currentIndex = chunksData.length - 1;
                loadCard(currentIndex);
            }
        }

        function shuffleCards() {
            for (let i = chunksData.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [chunksData[i], chunksData[j]] = [chunksData[j], chunksData[i]];
            }
            currentIndex = 0;
            loadCard(0);
        }

        function playAudio() {
            const text = chunksData[currentIndex].chunk;
            const utterance = new SpeechSynthesisUtterance(text);
            utterance.lang = 'en-US';
            utterance.rate = 0.9; // 稍微慢一點點，適合學習
            window.speechSynthesis.speak(utterance);
        }

        // Keyboard navigation
        document.addEventListener('keydown', (e) => {
            if (e.code === 'Space') {
                flipCard();
                e.preventDefault(); // prevent scroll
            } else if (e.code === 'ArrowRight') {
                nextCard();
            } else if (e.code === 'ArrowLeft') {
                prevCard();
            }
        });
    </script>
</body>
</html>